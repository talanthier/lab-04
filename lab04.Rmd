---
title: "Lab 4"
author: "Tim Lanthier"
date: "2/9/2022"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(knitr)
library(broom)
```

# Lab 4: Analysis of Variance
## Exploratory Data Analysis
Dataset is the `diamonds` dataset from the ggplot2 package. For this analysis, we will only consider diamonds with a carat weight of 0.5.
```{r}
filtered_data <- diamonds %>% subset(carat == 0.5)
glimpse(filtered_data)
```
It looks like we now have 1,258 observations in our filtered dataset.
```{r}
ggplot(filtered_data, aes(cut)) +
  geom_bar() +
  labs(x = 'Cut', title = 'Distribution of Cut')
```

According to the above plot, we have the fewest number of diamonds with a fair or good cut. To address this, we will combine the fair and good cut categories so the distribution between various cuts are more uniform.

```{r}
filtered_data <- filtered_data %>%
  mutate(cut = fct_lump_n(cut, 3, other_level = 'Fair/Good'))
```

```{r}
ggplot(filtered_data, aes(cut)) +
  geom_bar() +
  labs(x = 'Cut', title = 'Distribution of Cut')
```
According to the above bar chart, it looks like we have successfully lumped all fair and good cut diamonds into a single category. Now we will investigate the relationship between diamond cut and its price.
```{r}
ggplot(filtered_data, aes(cut,price)) +
  geom_boxplot() +
  coord_flip() + 
  labs(x = 'Cut', y = 'Price', title = 'Diamond Cut vs Price')
```
```{r}
filtered_data %>% group_by(cut) %>% 
  summarise(mean_price = mean(price),
            std_dev_price = sd(price))
```
Looking at the above plots and summary statistics it is reasonable to assume that there may be some relationship between price of diamonds and its cut. We can see this as the mean prices for diamonds with a premium or ideal cut lie quite far above diamonds with fair or good cuts. This is supported by our boxplot as the upper 75% of diamonds with premium cut have prices which lie above the mean price for diamonds with fair/good cut. Of course this only applies to diamonds which are 0.5 carats since we removed all other diamonds from the dataset.

## Analysis of Variance




